{"version":3,"names":["cov_zvmnits5b","actualCoverage","s","ProjectProvider","f","useProject","ProjectContext","_react","createContext","context","useContext","b","Error","children","data","session","_react1","useSession","currentProject","setCurrentProject","useState","projects","setProjects","loading","setLoading","fetchProjects","response","fetch","ok","projectsData","json","savedProjectId","localStorage","getItem","selectedProject","find","p","id","status","setItem","error","console","switchProject","projectId","project","refreshProjects","useEffect","contextValue","_jsxruntime","jsx","Provider","value"],"sources":["/Users/kennyc/code/personal/nailit/app/components/ProjectContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { useSession } from 'next-auth/react';\n\ninterface Project {\n  id: string;\n  name: string;\n  description?: string;\n  address?: string;\n  addressPlaceId?: string;\n  addressLat?: number;\n  addressLng?: number;\n  budget?: number;\n  startDate: string;\n  endDate?: string;\n  status: 'ACTIVE' | 'ARCHIVED';\n  teamMembers?: Array<{\n    id: string;\n    name: string;\n    email: string;\n    role: 'GENERAL_CONTRACTOR' | 'ARCHITECT_DESIGNER' | 'PROJECT_MANAGER';\n  }>;\n  emailSettings?: {\n    monitoringEnabled: boolean;\n    notificationsEnabled: boolean;\n    weeklyReports: boolean;\n    highPriorityAlerts: boolean;\n  };\n  _count?: {\n    flaggedItems: number;\n    timelineEntries: number;\n  };\n}\n\ninterface ProjectContextType {\n  currentProject: Project | null;\n  projects: Project[];\n  loading: boolean;\n  switchProject: (projectId: string) => void;\n  refreshProjects: () => Promise<void>;\n}\n\nconst ProjectContext = createContext<ProjectContextType | null>(null);\n\nexport const useProject = () => {\n  const context = useContext(ProjectContext);\n  if (!context) {\n    throw new Error('useProject must be used within a ProjectProvider');\n  }\n  return context;\n};\n\ninterface ProjectProviderProps {\n  children: ReactNode;\n}\n\nexport const ProjectProvider: React.FC<ProjectProviderProps> = ({ children }) => {\n  const { data: session } = useSession();\n  const [currentProject, setCurrentProject] = useState<Project | null>(null);\n  const [projects, setProjects] = useState<Project[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  const fetchProjects = async () => {\n    if (!session) {\n      setLoading(false);\n      return;\n    }\n\n    try {\n      const response = await fetch('/api/projects');\n      if (response.ok) {\n        const projectsData = await response.json();\n        setProjects(projectsData);\n        \n        // Set current project (try to get from localStorage first, then default to first active, then first overall)\n        const savedProjectId = localStorage.getItem('currentProjectId');\n        let selectedProject = null;\n        \n        if (savedProjectId) {\n          selectedProject = projectsData.find((p: Project) => p.id === savedProjectId);\n        }\n        \n        if (!selectedProject) {\n          // Default to first active project, then first project overall\n          selectedProject = projectsData.find((p: Project) => p.status === 'ACTIVE') || projectsData[0];\n        }\n        \n        setCurrentProject(selectedProject || null);\n        \n        if (selectedProject) {\n          localStorage.setItem('currentProjectId', selectedProject.id);\n        }\n      }\n    } catch (error) {\n      console.error('Error fetching projects:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const switchProject = (projectId: string) => {\n    const project = projects.find(p => p.id === projectId);\n    if (project) {\n      setCurrentProject(project);\n      localStorage.setItem('currentProjectId', project.id);\n    }\n  };\n\n  const refreshProjects = async () => {\n    await fetchProjects();\n  };\n\n  useEffect(() => {\n    fetchProjects();\n  }, [session]);\n\n  const contextValue: ProjectContextType = {\n    currentProject,\n    projects,\n    loading,\n    switchProject,\n    refreshProjects\n  };\n\n  return (\n    <ProjectContext.Provider value={contextValue}>\n      {children}\n    </ProjectContext.Provider>\n  );\n}; "],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}