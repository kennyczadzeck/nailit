3cccb065231b5935ec6143a0e861d60e
/**
 * Centralized Prisma Mocking Utilities
 * Standardized mocking patterns for database operations
 */ // Mock Prisma client structure
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: Object.getOwnPropertyDescriptor(all, name).get
    });
}
_export(exports, {
    get createMockPrisma () {
        return createMockPrisma;
    },
    get givenDatabaseFails () {
        return givenDatabaseFails;
    },
    get givenDatabaseHas () {
        return givenDatabaseHas;
    },
    get mockPrisma () {
        return mockPrisma;
    },
    get setupMockPrisma () {
        return setupMockPrisma;
    },
    get setupPrismaMocks () {
        return setupPrismaMocks;
    }
});
const createMockPrisma = ()=>({
        project: {
            count: jest.fn(),
            findMany: jest.fn(),
            findUnique: jest.fn(),
            findFirst: jest.fn(),
            create: jest.fn(),
            update: jest.fn(),
            delete: jest.fn(),
            deleteMany: jest.fn()
        },
        user: {
            findUnique: jest.fn(),
            findFirst: jest.fn(),
            create: jest.fn(),
            update: jest.fn(),
            delete: jest.fn()
        },
        flaggedItem: {
            findMany: jest.fn(),
            create: jest.fn(),
            update: jest.fn(),
            delete: jest.fn()
        },
        timelineEntry: {
            findMany: jest.fn(),
            create: jest.fn()
        },
        emailSettings: {
            findUnique: jest.fn(),
            create: jest.fn(),
            update: jest.fn()
        }
    });
const mockPrisma = createMockPrisma();
const setupPrismaMocks = {
    // Project mocks
    projectCount: (count)=>{
        mockPrisma.project.count.mockResolvedValue(count);
    },
    projectsList: (projects)=>{
        mockPrisma.project.findMany.mockResolvedValue(projects);
        mockPrisma.project.count.mockResolvedValue(projects.length);
    },
    projectsEmpty: ()=>{
        mockPrisma.project.findMany.mockResolvedValue([]);
        mockPrisma.project.count.mockResolvedValue(0);
    },
    projectCreate: (project)=>{
        mockPrisma.project.create.mockResolvedValue(project);
    },
    projectCreateError: (error)=>{
        mockPrisma.project.create.mockRejectedValue(error);
    },
    // User mocks
    userFound: (user)=>{
        mockPrisma.user.findUnique.mockResolvedValue(user);
    },
    userNotFound: ()=>{
        mockPrisma.user.findUnique.mockResolvedValue(null);
    },
    // Database error scenarios
    databaseError: (error = new Error('Database connection failed'))=>{
        mockPrisma.project.findMany.mockRejectedValue(error);
        mockPrisma.project.count.mockRejectedValue(error);
        mockPrisma.user.findUnique.mockRejectedValue(error);
    },
    // Reset all mocks
    reset: ()=>{
        Object.values(mockPrisma).forEach((table)=>{
            Object.values(table).forEach((method)=>{
                if (jest.isMockFunction(method)) {
                    method.mockReset();
                }
            });
        });
    }
};
const givenDatabaseHas = {
    projects: (projects)=>{
        setupPrismaMocks.projectsList(projects);
    },
    noProjects: ()=>{
        setupPrismaMocks.projectsEmpty();
    },
    user: (user)=>{
        setupPrismaMocks.userFound(user);
    },
    noUser: ()=>{
        setupPrismaMocks.userNotFound();
    }
};
const givenDatabaseFails = {
    withError: (error)=>{
        setupPrismaMocks.databaseError(error);
    },
    onProjectCreation: ()=>{
        setupPrismaMocks.projectCreateError(new Error('Failed to create project'));
    }
};
const setupMockPrisma = ()=>{
    // Mock the Prisma module
    jest.doMock('../../../app/lib/prisma', ()=>({
            prisma: mockPrisma
        }));
    // Reset mocks before each test
    beforeEach(()=>{
        setupPrismaMocks.reset();
    });
    return mockPrisma;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9rZW5ueWMvY29kZS9wZXJzb25hbC9uYWlsaXQvdGVzdHMvaGVscGVycy9tb2NrUHJpc21hLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ2VudHJhbGl6ZWQgUHJpc21hIE1vY2tpbmcgVXRpbGl0aWVzXG4gKiBTdGFuZGFyZGl6ZWQgbW9ja2luZyBwYXR0ZXJucyBmb3IgZGF0YWJhc2Ugb3BlcmF0aW9uc1xuICovXG5cbi8vIE1vY2sgUHJpc21hIGNsaWVudCBzdHJ1Y3R1cmVcbmV4cG9ydCBjb25zdCBjcmVhdGVNb2NrUHJpc21hID0gKCkgPT4gKHtcbiAgcHJvamVjdDoge1xuICAgIGNvdW50OiBqZXN0LmZuKCksXG4gICAgZmluZE1hbnk6IGplc3QuZm4oKSxcbiAgICBmaW5kVW5pcXVlOiBqZXN0LmZuKCksXG4gICAgZmluZEZpcnN0OiBqZXN0LmZuKCksXG4gICAgY3JlYXRlOiBqZXN0LmZuKCksXG4gICAgdXBkYXRlOiBqZXN0LmZuKCksXG4gICAgZGVsZXRlOiBqZXN0LmZuKCksXG4gICAgZGVsZXRlTWFueTogamVzdC5mbigpLFxuICB9LFxuICB1c2VyOiB7XG4gICAgZmluZFVuaXF1ZTogamVzdC5mbigpLFxuICAgIGZpbmRGaXJzdDogamVzdC5mbigpLFxuICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgIHVwZGF0ZTogamVzdC5mbigpLFxuICAgIGRlbGV0ZTogamVzdC5mbigpLFxuICB9LFxuICBmbGFnZ2VkSXRlbToge1xuICAgIGZpbmRNYW55OiBqZXN0LmZuKCksXG4gICAgY3JlYXRlOiBqZXN0LmZuKCksXG4gICAgdXBkYXRlOiBqZXN0LmZuKCksXG4gICAgZGVsZXRlOiBqZXN0LmZuKCksXG4gIH0sXG4gIHRpbWVsaW5lRW50cnk6IHtcbiAgICBmaW5kTWFueTogamVzdC5mbigpLFxuICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICB9LFxuICBlbWFpbFNldHRpbmdzOiB7XG4gICAgZmluZFVuaXF1ZTogamVzdC5mbigpLFxuICAgIGNyZWF0ZTogamVzdC5mbigpLFxuICAgIHVwZGF0ZTogamVzdC5mbigpLFxuICB9LFxufSlcblxuLy8gR2xvYmFsIG1vY2sgUHJpc21hIGluc3RhbmNlXG5leHBvcnQgY29uc3QgbW9ja1ByaXNtYSA9IGNyZWF0ZU1vY2tQcmlzbWEoKVxuXG4vLyBTZXR1cCBQcmlzbWEgbW9ja3MgZm9yIGNvbW1vbiBzY2VuYXJpb3NcbmV4cG9ydCBjb25zdCBzZXR1cFByaXNtYU1vY2tzID0ge1xuICAvLyBQcm9qZWN0IG1vY2tzXG4gIHByb2plY3RDb3VudDogKGNvdW50OiBudW1iZXIpID0+IHtcbiAgICBtb2NrUHJpc21hLnByb2plY3QuY291bnQubW9ja1Jlc29sdmVkVmFsdWUoY291bnQpXG4gIH0sXG5cbiAgcHJvamVjdHNMaXN0OiAocHJvamVjdHM6IGFueVtdKSA9PiB7XG4gICAgbW9ja1ByaXNtYS5wcm9qZWN0LmZpbmRNYW55Lm1vY2tSZXNvbHZlZFZhbHVlKHByb2plY3RzKVxuICAgIG1vY2tQcmlzbWEucHJvamVjdC5jb3VudC5tb2NrUmVzb2x2ZWRWYWx1ZShwcm9qZWN0cy5sZW5ndGgpXG4gIH0sXG5cbiAgcHJvamVjdHNFbXB0eTogKCkgPT4ge1xuICAgIG1vY2tQcmlzbWEucHJvamVjdC5maW5kTWFueS5tb2NrUmVzb2x2ZWRWYWx1ZShbXSlcbiAgICBtb2NrUHJpc21hLnByb2plY3QuY291bnQubW9ja1Jlc29sdmVkVmFsdWUoMClcbiAgfSxcblxuICBwcm9qZWN0Q3JlYXRlOiAocHJvamVjdDogYW55KSA9PiB7XG4gICAgbW9ja1ByaXNtYS5wcm9qZWN0LmNyZWF0ZS5tb2NrUmVzb2x2ZWRWYWx1ZShwcm9qZWN0KVxuICB9LFxuXG4gIHByb2plY3RDcmVhdGVFcnJvcjogKGVycm9yOiBFcnJvcikgPT4ge1xuICAgIG1vY2tQcmlzbWEucHJvamVjdC5jcmVhdGUubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpXG4gIH0sXG5cbiAgLy8gVXNlciBtb2Nrc1xuICB1c2VyRm91bmQ6ICh1c2VyOiBhbnkpID0+IHtcbiAgICBtb2NrUHJpc21hLnVzZXIuZmluZFVuaXF1ZS5tb2NrUmVzb2x2ZWRWYWx1ZSh1c2VyKVxuICB9LFxuXG4gIHVzZXJOb3RGb3VuZDogKCkgPT4ge1xuICAgIG1vY2tQcmlzbWEudXNlci5maW5kVW5pcXVlLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpXG4gIH0sXG5cbiAgLy8gRGF0YWJhc2UgZXJyb3Igc2NlbmFyaW9zXG4gIGRhdGFiYXNlRXJyb3I6IChlcnJvcjogRXJyb3IgPSBuZXcgRXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJykpID0+IHtcbiAgICBtb2NrUHJpc21hLnByb2plY3QuZmluZE1hbnkubW9ja1JlamVjdGVkVmFsdWUoZXJyb3IpXG4gICAgbW9ja1ByaXNtYS5wcm9qZWN0LmNvdW50Lm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKVxuICAgIG1vY2tQcmlzbWEudXNlci5maW5kVW5pcXVlLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKVxuICB9LFxuXG4gIC8vIFJlc2V0IGFsbCBtb2Nrc1xuICByZXNldDogKCkgPT4ge1xuICAgIE9iamVjdC52YWx1ZXMobW9ja1ByaXNtYSkuZm9yRWFjaCgodGFibGUpID0+IHtcbiAgICAgIE9iamVjdC52YWx1ZXModGFibGUpLmZvckVhY2goKG1ldGhvZCkgPT4ge1xuICAgICAgICBpZiAoamVzdC5pc01vY2tGdW5jdGlvbihtZXRob2QpKSB7XG4gICAgICAgICAgbWV0aG9kLm1vY2tSZXNldCgpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSlcbiAgfSxcbn1cblxuLy8gQkRELXN0eWxlIG1vY2sgaGVscGVyc1xuZXhwb3J0IGNvbnN0IGdpdmVuRGF0YWJhc2VIYXMgPSB7XG4gIHByb2plY3RzOiAocHJvamVjdHM6IGFueVtdKSA9PiB7XG4gICAgc2V0dXBQcmlzbWFNb2Nrcy5wcm9qZWN0c0xpc3QocHJvamVjdHMpXG4gIH0sXG5cbiAgbm9Qcm9qZWN0czogKCkgPT4ge1xuICAgIHNldHVwUHJpc21hTW9ja3MucHJvamVjdHNFbXB0eSgpXG4gIH0sXG5cbiAgdXNlcjogKHVzZXI6IGFueSkgPT4ge1xuICAgIHNldHVwUHJpc21hTW9ja3MudXNlckZvdW5kKHVzZXIpXG4gIH0sXG5cbiAgbm9Vc2VyOiAoKSA9PiB7XG4gICAgc2V0dXBQcmlzbWFNb2Nrcy51c2VyTm90Rm91bmQoKVxuICB9LFxufVxuXG5leHBvcnQgY29uc3QgZ2l2ZW5EYXRhYmFzZUZhaWxzID0ge1xuICB3aXRoRXJyb3I6IChlcnJvcj86IEVycm9yKSA9PiB7XG4gICAgc2V0dXBQcmlzbWFNb2Nrcy5kYXRhYmFzZUVycm9yKGVycm9yKVxuICB9LFxuXG4gIG9uUHJvamVjdENyZWF0aW9uOiAoKSA9PiB7XG4gICAgc2V0dXBQcmlzbWFNb2Nrcy5wcm9qZWN0Q3JlYXRlRXJyb3IobmV3IEVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIHByb2plY3QnKSlcbiAgfSxcbn1cblxuLy8gTW9jayBzZXR1cCBmb3IgSmVzdCB0ZXN0c1xuZXhwb3J0IGNvbnN0IHNldHVwTW9ja1ByaXNtYSA9ICgpID0+IHtcbiAgLy8gTW9jayB0aGUgUHJpc21hIG1vZHVsZVxuICBqZXN0LmRvTW9jaygnLi4vLi4vLi4vYXBwL2xpYi9wcmlzbWEnLCAoKSA9PiAoe1xuICAgIHByaXNtYTogbW9ja1ByaXNtYSxcbiAgfSkpXG5cbiAgLy8gUmVzZXQgbW9ja3MgYmVmb3JlIGVhY2ggdGVzdFxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBzZXR1cFByaXNtYU1vY2tzLnJlc2V0KClcbiAgfSlcblxuICByZXR1cm4gbW9ja1ByaXNtYVxufSAiXSwibmFtZXMiOlsiY3JlYXRlTW9ja1ByaXNtYSIsImdpdmVuRGF0YWJhc2VGYWlscyIsImdpdmVuRGF0YWJhc2VIYXMiLCJtb2NrUHJpc21hIiwic2V0dXBNb2NrUHJpc21hIiwic2V0dXBQcmlzbWFNb2NrcyIsInByb2plY3QiLCJjb3VudCIsImplc3QiLCJmbiIsImZpbmRNYW55IiwiZmluZFVuaXF1ZSIsImZpbmRGaXJzdCIsImNyZWF0ZSIsInVwZGF0ZSIsImRlbGV0ZSIsImRlbGV0ZU1hbnkiLCJ1c2VyIiwiZmxhZ2dlZEl0ZW0iLCJ0aW1lbGluZUVudHJ5IiwiZW1haWxTZXR0aW5ncyIsInByb2plY3RDb3VudCIsIm1vY2tSZXNvbHZlZFZhbHVlIiwicHJvamVjdHNMaXN0IiwicHJvamVjdHMiLCJsZW5ndGgiLCJwcm9qZWN0c0VtcHR5IiwicHJvamVjdENyZWF0ZSIsInByb2plY3RDcmVhdGVFcnJvciIsImVycm9yIiwibW9ja1JlamVjdGVkVmFsdWUiLCJ1c2VyRm91bmQiLCJ1c2VyTm90Rm91bmQiLCJkYXRhYmFzZUVycm9yIiwiRXJyb3IiLCJyZXNldCIsIk9iamVjdCIsInZhbHVlcyIsImZvckVhY2giLCJ0YWJsZSIsIm1ldGhvZCIsImlzTW9ja0Z1bmN0aW9uIiwibW9ja1Jlc2V0Iiwibm9Qcm9qZWN0cyIsIm5vVXNlciIsIndpdGhFcnJvciIsIm9uUHJvamVjdENyZWF0aW9uIiwiZG9Nb2NrIiwicHJpc21hIiwiYmVmb3JlRWFjaCJdLCJtYXBwaW5ncyI6IkFBQUE7OztDQUdDLEdBRUQsK0JBQStCOzs7Ozs7Ozs7Ozs7UUFDbEJBO2VBQUFBOztRQThHQUM7ZUFBQUE7O1FBbEJBQztlQUFBQTs7UUF4REFDO2VBQUFBOztRQXFGQUM7ZUFBQUE7O1FBbEZBQztlQUFBQTs7O0FBdkNOLE1BQU1MLG1CQUFtQixJQUFPLENBQUE7UUFDckNNLFNBQVM7WUFDUEMsT0FBT0MsS0FBS0MsRUFBRTtZQUNkQyxVQUFVRixLQUFLQyxFQUFFO1lBQ2pCRSxZQUFZSCxLQUFLQyxFQUFFO1lBQ25CRyxXQUFXSixLQUFLQyxFQUFFO1lBQ2xCSSxRQUFRTCxLQUFLQyxFQUFFO1lBQ2ZLLFFBQVFOLEtBQUtDLEVBQUU7WUFDZk0sUUFBUVAsS0FBS0MsRUFBRTtZQUNmTyxZQUFZUixLQUFLQyxFQUFFO1FBQ3JCO1FBQ0FRLE1BQU07WUFDSk4sWUFBWUgsS0FBS0MsRUFBRTtZQUNuQkcsV0FBV0osS0FBS0MsRUFBRTtZ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