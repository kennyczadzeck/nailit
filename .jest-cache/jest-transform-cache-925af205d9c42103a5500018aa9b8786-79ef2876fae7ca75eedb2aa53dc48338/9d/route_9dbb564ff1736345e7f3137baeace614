98b729c2d9c2db9d05dfa6fb77877ccc
"use strict";

/* istanbul ignore next */
function cov_2m399r5j6y() {
  var path = "/Users/kennyc/code/personal/nailit/app/api/flagged-items/route.ts";
  var hash = "8f33b2cfce5b7f0e142114565a7f2b2ff684df8e";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/kennyc/code/personal/nailit/app/api/flagged-items/route.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 0
        },
        end: {
          line: 4,
          column: 3
        }
      },
      "1": {
        start: {
          line: 5,
          column: 0
        },
        end: {
          line: 10,
          column: 3
        }
      },
      "2": {
        start: {
          line: 8,
          column: 8
        },
        end: {
          line: 8,
          column: 19
        }
      },
      "3": {
        start: {
          line: 11,
          column: 16
        },
        end: {
          line: 11,
          column: 38
        }
      },
      "4": {
        start: {
          line: 12,
          column: 16
        },
        end: {
          line: 12,
          column: 43
        }
      },
      "5": {
        start: {
          line: 14,
          column: 4
        },
        end: {
          line: 57,
          column: 5
        }
      },
      "6": {
        start: {
          line: 15,
          column: 33
        },
        end: {
          line: 15,
          column: 53
        }
      },
      "7": {
        start: {
          line: 16,
          column: 26
        },
        end: {
          line: 16,
          column: 55
        }
      },
      "8": {
        start: {
          line: 17,
          column: 8
        },
        end: {
          line: 23,
          column: 9
        }
      },
      "9": {
        start: {
          line: 18,
          column: 12
        },
        end: {
          line: 22,
          column: 15
        }
      },
      "10": {
        start: {
          line: 24,
          column: 29
        },
        end: {
          line: 32,
          column: 10
        }
      },
      "11": {
        start: {
          line: 34,
          column: 33
        },
        end: {
          line: 48,
          column: 15
        }
      },
      "12": {
        start: {
          line: 34,
          column: 59
        },
        end: {
          line: 48,
          column: 13
        }
      },
      "13": {
        start: {
          line: 49,
          column: 8
        },
        end: {
          line: 49,
          column: 59
        }
      },
      "14": {
        start: {
          line: 51,
          column: 8
        },
        end: {
          line: 51,
          column: 62
        }
      },
      "15": {
        start: {
          line: 52,
          column: 8
        },
        end: {
          line: 56,
          column: 11
        }
      },
      "16": {
        start: {
          line: 61,
          column: 16
        },
        end: {
          line: 61,
          column: 26
        }
      },
      "17": {
        start: {
          line: 62,
          column: 19
        },
        end: {
          line: 62,
          column: 49
        }
      },
      "18": {
        start: {
          line: 63,
          column: 22
        },
        end: {
          line: 63,
          column: 59
        }
      },
      "19": {
        start: {
          line: 64,
          column: 21
        },
        end: {
          line: 64,
          column: 47
        }
      },
      "20": {
        start: {
          line: 65,
          column: 4
        },
        end: {
          line: 73,
          column: 5
        }
      },
      "21": {
        start: {
          line: 66,
          column: 8
        },
        end: {
          line: 66,
          column: 26
        }
      },
      "22": {
        start: {
          line: 67,
          column: 11
        },
        end: {
          line: 73,
          column: 5
        }
      },
      "23": {
        start: {
          line: 68,
          column: 8
        },
        end: {
          line: 68,
          column: 68
        }
      },
      "24": {
        start: {
          line: 69,
          column: 11
        },
        end: {
          line: 73,
          column: 5
        }
      },
      "25": {
        start: {
          line: 70,
          column: 8
        },
        end: {
          line: 70,
          column: 27
        }
      },
      "26": {
        start: {
          line: 72,
          column: 8
        },
        end: {
          line: 72,
          column: 38
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 7,
            column: 9
          },
          end: {
            line: 7,
            column: 10
          }
        },
        loc: {
          start: {
            line: 7,
            column: 20
          },
          end: {
            line: 9,
            column: 5
          }
        },
        line: 7
      },
      "1": {
        name: "GET",
        decl: {
          start: {
            line: 13,
            column: 15
          },
          end: {
            line: 13,
            column: 18
          }
        },
        loc: {
          start: {
            line: 13,
            column: 28
          },
          end: {
            line: 58,
            column: 1
          }
        },
        line: 13
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 34,
            column: 50
          },
          end: {
            line: 34,
            column: 51
          }
        },
        loc: {
          start: {
            line: 34,
            column: 59
          },
          end: {
            line: 48,
            column: 13
          }
        },
        line: 34
      },
      "3": {
        name: "getRelativeTime",
        decl: {
          start: {
            line: 60,
            column: 9
          },
          end: {
            line: 60,
            column: 24
          }
        },
        loc: {
          start: {
            line: 60,
            column: 31
          },
          end: {
            line: 74,
            column: 1
          }
        },
        line: 60
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 17,
            column: 8
          },
          end: {
            line: 23,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 17,
            column: 8
          },
          end: {
            line: 23,
            column: 9
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 17
      },
      "1": {
        loc: {
          start: {
            line: 47,
            column: 33
          },
          end: {
            line: 47,
            column: 59
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 47,
            column: 33
          },
          end: {
            line: 47,
            column: 53
          }
        }, {
          start: {
            line: 47,
            column: 57
          },
          end: {
            line: 47,
            column: 59
          }
        }],
        line: 47
      },
      "2": {
        loc: {
          start: {
            line: 65,
            column: 4
          },
          end: {
            line: 73,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 65,
            column: 4
          },
          end: {
            line: 73,
            column: 5
          }
        }, {
          start: {
            line: 67,
            column: 11
          },
          end: {
            line: 73,
            column: 5
          }
        }],
        line: 65
      },
      "3": {
        loc: {
          start: {
            line: 67,
            column: 11
          },
          end: {
            line: 73,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 67,
            column: 11
          },
          end: {
            line: 73,
            column: 5
          }
        }, {
          start: {
            line: 69,
            column: 11
          },
          end: {
            line: 73,
            column: 5
          }
        }],
        line: 67
      },
      "4": {
        loc: {
          start: {
            line: 68,
            column: 35
          },
          end: {
            line: 68,
            column: 61
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 68,
            column: 53
          },
          end: {
            line: 68,
            column: 55
          }
        }, {
          start: {
            line: 68,
            column: 58
          },
          end: {
            line: 68,
            column: 61
          }
        }],
        line: 68
      },
      "5": {
        loc: {
          start: {
            line: 69,
            column: 11
          },
          end: {
            line: 73,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 69,
            column: 11
          },
          end: {
            line: 73,
            column: 5
          }
        }, {
          start: {
            line: 71,
            column: 11
          },
          end: {
            line: 73,
            column: 5
          }
        }],
        line: 69
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      sources: ["/Users/kennyc/code/personal/nailit/app/api/flagged-items/route.ts"],
      sourcesContent: ["import { NextRequest, NextResponse } from 'next/server'\nimport { prisma } from '../../lib/prisma'\n\n// GET /api/flagged-items - Get all flagged items for a project\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const projectId = searchParams.get('projectId')\n\n    if (!projectId) {\n      return NextResponse.json(\n        { error: 'Project ID is required' },\n        { status: 400 }\n      )\n    }\n\n    const flaggedItems = await prisma.flaggedItem.findMany({\n      where: {\n        projectId,\n        status: 'PENDING' // Only show pending items\n      },\n      orderBy: {\n        emailDate: 'desc'\n      }\n    })\n\n    // Transform the data to match frontend expectations\n    const transformedItems = flaggedItems.map(item => ({\n      id: item.id,\n      category: item.category.toLowerCase(),\n      title: item.title,\n      description: item.description,\n      impact: item.impact,\n      date: item.emailDate.toISOString().split('T')[0],\n      time: getRelativeTime(item.emailDate),\n      emailFrom: item.emailFrom,\n      project: 'Kitchen Renovation', // TODO: Get from project relation\n      needsEmailResponse: item.needsEmailResponse,\n      aiConfidence: item.aiConfidence,\n      originalEmail: item.originalEmail,\n      detectedChanges: item.detectedChanges as string[] || []\n    }))\n\n    return NextResponse.json(transformedItems)\n  } catch (error) {\n    console.error('Error fetching flagged items:', error)\n    return NextResponse.json(\n      { error: 'Failed to fetch flagged items' },\n      { status: 500 }\n    )\n  }\n}\n\n// Helper function to get relative time\nfunction getRelativeTime(date: Date): string {\n  const now = new Date()\n  const diffMs = now.getTime() - date.getTime()\n  const diffHours = Math.floor(diffMs / (1000 * 60 * 60))\n  const diffDays = Math.floor(diffHours / 24)\n\n  if (diffHours < 1) {\n    return 'Just now'\n  } else if (diffHours < 24) {\n    return `${diffHours} hour${diffHours === 1 ? '' : 's'} ago`\n  } else if (diffDays === 1) {\n    return '1 day ago'\n  } else {\n    return `${diffDays} days ago`\n  }\n} "],
      names: ["GET", "request", "searchParams", "URL", "url", "projectId", "get", "NextResponse", "json", "error", "status", "flaggedItems", "prisma", "flaggedItem", "findMany", "where", "orderBy", "emailDate", "transformedItems", "map", "item", "id", "category", "toLowerCase", "title", "description", "impact", "date", "toISOString", "split", "time", "getRelativeTime", "emailFrom", "project", "needsEmailResponse", "aiConfidence", "originalEmail", "detectedChanges", "console", "now", "Date", "diffMs", "getTime", "diffHours", "Math", "floor", "diffDays"],
      mappings: ";;;;+BAIsBA;;;eAAAA;;;wBAJoB;wBACnB;AAGhB,eAAeA,IAAIC,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAEC,YAAY,EAAE,GAAG,IAAIC,IAAIF,QAAQG,GAAG;QAC5C,MAAMC,YAAYH,aAAaI,GAAG,CAAC;QAEnC,IAAI,CAACD,WAAW;YACd,OAAOE,oBAAY,CAACC,IAAI,CACtB;gBAAEC,OAAO;YAAyB,GAClC;gBAAEC,QAAQ;YAAI;QAElB;QAEA,MAAMC,eAAe,MAAMC,cAAM,CAACC,WAAW,CAACC,QAAQ,CAAC;YACrDC,OAAO;gBACLV;gBACAK,QAAQ,UAAU,0BAA0B;YAC9C;YACAM,SAAS;gBACPC,WAAW;YACb;QACF;QAEA,oDAAoD;QACpD,MAAMC,mBAAmBP,aAAaQ,GAAG,CAACC,CAAAA,OAAS,CAAA;gBACjDC,IAAID,KAAKC,EAAE;gBACXC,UAAUF,KAAKE,QAAQ,CAACC,WAAW;gBACnCC,OAAOJ,KAAKI,KAAK;gBACjBC,aAAaL,KAAKK,WAAW;gBAC7BC,QAAQN,KAAKM,MAAM;gBACnBC,MAAMP,KAAKH,SAAS,CAACW,WAAW,GAAGC,KAAK,CAAC,IAAI,CAAC,EAAE;gBAChDC,MAAMC,gBAAgBX,KAAKH,SAAS;gBACpCe,WAAWZ,KAAKY,SAAS;gBACzBC,SAAS;gBACTC,oBAAoBd,KAAKc,kBAAkB;gBAC3CC,cAAcf,KAAKe,YAAY;gBAC/BC,eAAehB,KAAKgB,aAAa;gBACjCC,iBAAiBjB,KAAKiB,eAAe,IAAgB,EAAE;YACzD,CAAA;QAEA,OAAO9B,oBAAY,CAACC,IAAI,CAACU;IAC3B,EAAE,OAAOT,OAAO;QACd6B,QAAQ7B,KAAK,CAAC,iCAAiCA;QAC/C,OAAOF,oBAAY,CAACC,IAAI,CACtB;YAAEC,OAAO;QAAgC,GACzC;YAAEC,QAAQ;QAAI;IAElB;AACF;AAEA,uCAAuC;AACvC,SAASqB,gBAAgBJ,IAAU;IACjC,MAAMY,MAAM,IAAIC;IAChB,MAAMC,SAASF,IAAIG,OAAO,KAAKf,KAAKe,OAAO;IAC3C,MAAMC,YAAYC,KAAKC,KAAK,CAACJ,SAAU,CAAA,OAAO,KAAK,EAAC;IACpD,MAAMK,WAAWF,KAAKC,KAAK,CAACF,YAAY;IAExC,IAAIA,YAAY,GAAG;QACjB,OAAO;IACT,OAAO,IAAIA,YAAY,IAAI;QACzB,OAAO,GAAGA,UAAU,KAAK,EAAEA,cAAc,IAAI,KAAK,IAAI,IAAI,CAAC;IAC7D,OAAO,IAAIG,aAAa,GAAG;QACzB,OAAO;IACT,OAAO;QACL,OAAO,GAAGA,SAAS,SAAS,CAAC;IAC/B;AACF"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "8f33b2cfce5b7f0e142114565a7f2b2ff684df8e"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2m399r5j6y = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_2m399r5j6y();
cov_2m399r5j6y().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_2m399r5j6y().s[1]++;
Object.defineProperty(exports, "GET", {
  enumerable: true,
  get: function () {
    /* istanbul ignore next */
    cov_2m399r5j6y().f[0]++;
    cov_2m399r5j6y().s[2]++;
    return GET;
  }
});
const _server =
/* istanbul ignore next */
(cov_2m399r5j6y().s[3]++, require("next/server"));
const _prisma =
/* istanbul ignore next */
(cov_2m399r5j6y().s[4]++, require("../../lib/prisma"));
async function GET(request) {
  /* istanbul ignore next */
  cov_2m399r5j6y().f[1]++;
  cov_2m399r5j6y().s[5]++;
  try {
    const {
      searchParams
    } =
    /* istanbul ignore next */
    (cov_2m399r5j6y().s[6]++, new URL(request.url));
    const projectId =
    /* istanbul ignore next */
    (cov_2m399r5j6y().s[7]++, searchParams.get('projectId'));
    /* istanbul ignore next */
    cov_2m399r5j6y().s[8]++;
    if (!projectId) {
      /* istanbul ignore next */
      cov_2m399r5j6y().b[0][0]++;
      cov_2m399r5j6y().s[9]++;
      return _server.NextResponse.json({
        error: 'Project ID is required'
      }, {
        status: 400
      });
    } else
    /* istanbul ignore next */
    {
      cov_2m399r5j6y().b[0][1]++;
    }
    const flaggedItems =
    /* istanbul ignore next */
    (cov_2m399r5j6y().s[10]++, await _prisma.prisma.flaggedItem.findMany({
      where: {
        projectId,
        status: 'PENDING' // Only show pending items
      },
      orderBy: {
        emailDate: 'desc'
      }
    }));
    // Transform the data to match frontend expectations
    const transformedItems =
    /* istanbul ignore next */
    (cov_2m399r5j6y().s[11]++, flaggedItems.map(item => {
      /* istanbul ignore next */
      cov_2m399r5j6y().f[2]++;
      cov_2m399r5j6y().s[12]++;
      return {
        id: item.id,
        category: item.category.toLowerCase(),
        title: item.title,
        description: item.description,
        impact: item.impact,
        date: item.emailDate.toISOString().split('T')[0],
        time: getRelativeTime(item.emailDate),
        emailFrom: item.emailFrom,
        project: 'Kitchen Renovation',
        needsEmailResponse: item.needsEmailResponse,
        aiConfidence: item.aiConfidence,
        originalEmail: item.originalEmail,
        detectedChanges:
        /* istanbul ignore next */
        (cov_2m399r5j6y().b[1][0]++, item.detectedChanges) ||
        /* istanbul ignore next */
        (cov_2m399r5j6y().b[1][1]++, [])
      };
    }));
    /* istanbul ignore next */
    cov_2m399r5j6y().s[13]++;
    return _server.NextResponse.json(transformedItems);
  } catch (error) {
    /* istanbul ignore next */
    cov_2m399r5j6y().s[14]++;
    console.error('Error fetching flagged items:', error);
    /* istanbul ignore next */
    cov_2m399r5j6y().s[15]++;
    return _server.NextResponse.json({
      error: 'Failed to fetch flagged items'
    }, {
      status: 500
    });
  }
}
// Helper function to get relative time
function getRelativeTime(date) {
  /* istanbul ignore next */
  cov_2m399r5j6y().f[3]++;
  const now =
  /* istanbul ignore next */
  (cov_2m399r5j6y().s[16]++, new Date());
  const diffMs =
  /* istanbul ignore next */
  (cov_2m399r5j6y().s[17]++, now.getTime() - date.getTime());
  const diffHours =
  /* istanbul ignore next */
  (cov_2m399r5j6y().s[18]++, Math.floor(diffMs / (1000 * 60 * 60)));
  const diffDays =
  /* istanbul ignore next */
  (cov_2m399r5j6y().s[19]++, Math.floor(diffHours / 24));
  /* istanbul ignore next */
  cov_2m399r5j6y().s[20]++;
  if (diffHours < 1) {
    /* istanbul ignore next */
    cov_2m399r5j6y().b[2][0]++;
    cov_2m399r5j6y().s[21]++;
    return 'Just now';
  } else {
    /* istanbul ignore next */
    cov_2m399r5j6y().b[2][1]++;
    cov_2m399r5j6y().s[22]++;
    if (diffHours < 24) {
      /* istanbul ignore next */
      cov_2m399r5j6y().b[3][0]++;
      cov_2m399r5j6y().s[23]++;
      return `${diffHours} hour${diffHours === 1 ?
      /* istanbul ignore next */
      (cov_2m399r5j6y().b[4][0]++, '') :
      /* istanbul ignore next */
      (cov_2m399r5j6y().b[4][1]++, 's')} ago`;
    } else {
      /* istanbul ignore next */
      cov_2m399r5j6y().b[3][1]++;
      cov_2m399r5j6y().s[24]++;
      if (diffDays === 1) {
        /* istanbul ignore next */
        cov_2m399r5j6y().b[5][0]++;
        cov_2m399r5j6y().s[25]++;
        return '1 day ago';
      } else {
        /* istanbul ignore next */
        cov_2m399r5j6y().b[5][1]++;
        cov_2m399r5j6y().s[26]++;
        return `${diffDays} days ago`;
      }
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMm0zOTlyNWo2eSIsImFjdHVhbENvdmVyYWdlIiwicyIsIkdFVCIsInJlcXVlc3QiLCJmIiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwicHJvamVjdElkIiwiZ2V0IiwiYiIsIl9zZXJ2ZXIiLCJOZXh0UmVzcG9uc2UiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJmbGFnZ2VkSXRlbXMiLCJfcHJpc21hIiwicHJpc21hIiwiZmxhZ2dlZEl0ZW0iLCJmaW5kTWFueSIsIndoZXJlIiwib3JkZXJCeSIsImVtYWlsRGF0ZSIsInRyYW5zZm9ybWVkSXRlbXMiLCJtYXAiLCJpdGVtIiwiaWQiLCJjYXRlZ29yeSIsInRvTG93ZXJDYXNlIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImltcGFjdCIsImRhdGUiLCJ0b0lTT1N0cmluZyIsInNwbGl0IiwidGltZSIsImdldFJlbGF0aXZlVGltZSIsImVtYWlsRnJvbSIsInByb2plY3QiLCJuZWVkc0VtYWlsUmVzcG9uc2UiLCJhaUNvbmZpZGVuY2UiLCJvcmlnaW5hbEVtYWlsIiwiZGV0ZWN0ZWRDaGFuZ2VzIiwiY29uc29sZSIsIm5vdyIsIkRhdGUiLCJkaWZmTXMiLCJnZXRUaW1lIiwiZGlmZkhvdXJzIiwiTWF0aCIsImZsb29yIiwiZGlmZkRheXMiXSwic291cmNlcyI6WyIvVXNlcnMva2VubnljL2NvZGUvcGVyc29uYWwvbmFpbGl0L2FwcC9hcGkvZmxhZ2dlZC1pdGVtcy9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuLi8uLi9saWIvcHJpc21hJ1xuXG4vLyBHRVQgL2FwaS9mbGFnZ2VkLWl0ZW1zIC0gR2V0IGFsbCBmbGFnZ2VkIGl0ZW1zIGZvciBhIHByb2plY3RcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgICBjb25zdCBwcm9qZWN0SWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdwcm9qZWN0SWQnKVxuXG4gICAgaWYgKCFwcm9qZWN0SWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ1Byb2plY3QgSUQgaXMgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIGNvbnN0IGZsYWdnZWRJdGVtcyA9IGF3YWl0IHByaXNtYS5mbGFnZ2VkSXRlbS5maW5kTWFueSh7XG4gICAgICB3aGVyZToge1xuICAgICAgICBwcm9qZWN0SWQsXG4gICAgICAgIHN0YXR1czogJ1BFTkRJTkcnIC8vIE9ubHkgc2hvdyBwZW5kaW5nIGl0ZW1zXG4gICAgICB9LFxuICAgICAgb3JkZXJCeToge1xuICAgICAgICBlbWFpbERhdGU6ICdkZXNjJ1xuICAgICAgfVxuICAgIH0pXG5cbiAgICAvLyBUcmFuc2Zvcm0gdGhlIGRhdGEgdG8gbWF0Y2ggZnJvbnRlbmQgZXhwZWN0YXRpb25zXG4gICAgY29uc3QgdHJhbnNmb3JtZWRJdGVtcyA9IGZsYWdnZWRJdGVtcy5tYXAoaXRlbSA9PiAoe1xuICAgICAgaWQ6IGl0ZW0uaWQsXG4gICAgICBjYXRlZ29yeTogaXRlbS5jYXRlZ29yeS50b0xvd2VyQ2FzZSgpLFxuICAgICAgdGl0bGU6IGl0ZW0udGl0bGUsXG4gICAgICBkZXNjcmlwdGlvbjogaXRlbS5kZXNjcmlwdGlvbixcbiAgICAgIGltcGFjdDogaXRlbS5pbXBhY3QsXG4gICAgICBkYXRlOiBpdGVtLmVtYWlsRGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0sXG4gICAgICB0aW1lOiBnZXRSZWxhdGl2ZVRpbWUoaXRlbS5lbWFpbERhdGUpLFxuICAgICAgZW1haWxGcm9tOiBpdGVtLmVtYWlsRnJvbSxcbiAgICAgIHByb2plY3Q6ICdLaXRjaGVuIFJlbm92YXRpb24nLCAvLyBUT0RPOiBHZXQgZnJvbSBwcm9qZWN0IHJlbGF0aW9uXG4gICAgICBuZWVkc0VtYWlsUmVzcG9uc2U6IGl0ZW0ubmVlZHNFbWFpbFJlc3BvbnNlLFxuICAgICAgYWlDb25maWRlbmNlOiBpdGVtLmFpQ29uZmlkZW5jZSxcbiAgICAgIG9yaWdpbmFsRW1haWw6IGl0ZW0ub3JpZ2luYWxFbWFpbCxcbiAgICAgIGRldGVjdGVkQ2hhbmdlczogaXRlbS5kZXRlY3RlZENoYW5nZXMgYXMgc3RyaW5nW10gfHwgW11cbiAgICB9KSlcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih0cmFuc2Zvcm1lZEl0ZW1zKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGZsYWdnZWQgaXRlbXM6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBmZXRjaCBmbGFnZ2VkIGl0ZW1zJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59XG5cbi8vIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgcmVsYXRpdmUgdGltZVxuZnVuY3Rpb24gZ2V0UmVsYXRpdmVUaW1lKGRhdGU6IERhdGUpOiBzdHJpbmcge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gIGNvbnN0IGRpZmZNcyA9IG5vdy5nZXRUaW1lKCkgLSBkYXRlLmdldFRpbWUoKVxuICBjb25zdCBkaWZmSG91cnMgPSBNYXRoLmZsb29yKGRpZmZNcyAvICgxMDAwICogNjAgKiA2MCkpXG4gIGNvbnN0IGRpZmZEYXlzID0gTWF0aC5mbG9vcihkaWZmSG91cnMgLyAyNClcblxuICBpZiAoZGlmZkhvdXJzIDwgMSkge1xuICAgIHJldHVybiAnSnVzdCBub3cnXG4gIH0gZWxzZSBpZiAoZGlmZkhvdXJzIDwgMjQpIHtcbiAgICByZXR1cm4gYCR7ZGlmZkhvdXJzfSBob3VyJHtkaWZmSG91cnMgPT09IDEgPyAnJyA6ICdzJ30gYWdvYFxuICB9IGVsc2UgaWYgKGRpZmZEYXlzID09PSAxKSB7XG4gICAgcmV0dXJuICcxIGRheSBhZ28nXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGAke2RpZmZEYXlzfSBkYXlzIGFnb2BcbiAgfVxufSAiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQU9JO0lBQUFBLGNBQUEsWUFBQUEsQ0FBQTtNQUFBLE9BQUFDLGNBQUE7SUFBQTtFQUFBO0VBQUEsT0FBQUEsY0FBQTtBQUFBO0FBQUFELGNBQUE7QUFB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QUNGO0FBRUE7QUFDQSxTQUFTc0IsZ0JBQWdCSixJQUFVO0VBQUE7RUFBQWxDLGNBQUEsR0FBQUssQ0FBQTtFQUNqQyxNQUFNeUMsR0FBQTtFQUFBO0VBQUEsQ0FBQTlDLGNBQUEsR0FBQUUsQ0FBQSxRQUFNLElBQUk2QyxJQUFBO0VBQ2hCLE1BQU1DLE1BQUE7RUFBQTtFQUFBLENBQUFoRCxjQUFBLEdBQUFFLENBQUEsUUFBUzRDLEdBQUEsQ0FBSUcsT0FBTyxLQUFLZixJQUFBLENBQUtlLE9BQU87RUFDM0MsTUFBTUMsU0FBQTtFQUFBO0VBQUEsQ0FBQWxELGNBQUEsR0FBQUUsQ0FBQSxRQUFZaUQsSUFBQSxDQUFLQyxLQUFLLENBQUNKLE1BQUEsSUFBVSxPQUFPLEtBQUssRUFBQztFQUNwRCxNQUFNSyxRQUFBO0VBQUE7RUFBQSxDQUFBckQsY0FBQSxHQUFBRSxDQUFBLFFBQVdpRCxJQUFBLENBQUtDLEtBQUssQ0FBQ0YsU0FBQSxHQUFZO0VBQUE7RUFBQWxELGNBQUEsR0FBQUUsQ0FBQTtFQUV4QyxJQUFJZ0QsU0FBQSxHQUFZLEdBQUc7SUFBQTtJQUFBbEQsY0FBQSxHQUFBVyxDQUFBO0lBQUFYLGNBQUEsR0FBQUUsQ0FBQTtJQUNqQixPQUFPO0VBQ1QsT0FBTztJQUFBO0lBQUFGLGNBQUEsR0FBQVcsQ0FBQTtJQUFBWCxjQUFBLEdBQUFFLENBQUE7SUFBQSxJQUFJZ0QsU0FBQSxHQUFZLElBQUk7TUFBQTtNQUFBbEQsY0FBQSxHQUFBVyxDQUFBO01BQUFYLGNBQUEsR0FBQUUsQ0FBQTtNQUN6QixPQUFPLEdBQUdnRCxTQUFBLFFBQWlCQSxTQUFBLEtBQWM7TUFBQTtNQUFBLENBQUFsRCxjQUFBLEdBQUFXLENBQUEsVUFBSTtNQUFBO01BQUEsQ0FBQVgsY0FBQSxHQUFBVyxDQUFBLFVBQUssVUFBUztJQUM3RCxPQUFPO01BQUE7TUFBQVgsY0FBQSxHQUFBVyxDQUFBO01BQUFYLGNBQUEsR0FBQUUsQ0FBQTtNQUFBLElBQUltRCxRQUFBLEtBQWEsR0FBRztRQUFBO1FBQUFyRCxjQUFBLEdBQUFXLENBQUE7UUFBQVgsY0FBQSxHQUFBRSxDQUFBO1FBQ3pCLE9BQU87TUFDVCxPQUFPO1FBQUE7UUFBQUYsY0FBQSxHQUFBVyxDQUFBO1FBQUFYLGNBQUEsR0FBQUUsQ0FBQTtRQUNMLE9BQU8sR0FBR21ELFFBQUEsV0FBbUI7TUFDL0I7SUFBQTtFQUFBO0FBQ0YiLCJpZ25vcmVMaXN0IjpbXX0=