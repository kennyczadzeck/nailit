(()=>{var a={};a.id=6835,a.ids=[6835],a.modules={3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13700:(a,b,c)=>{"use strict";c.d(b,{z:()=>e});var d=c(96330);let e=globalThis.prisma??(()=>{let a="postgresql://neondb_owner:npg_avELx8uqOAc0@ep-still-paper-a5tgtem8-pooler.us-east-2.aws.neon.tech/neondb?sslmode=require".trim();if(!a)throw console.error("DATABASE_URL environment variable is not set"),console.error("Available env vars:",Object.keys(process.env).filter(a=>a.includes("DATABASE")||a.includes("NEON"))),Error("DATABASE_URL environment variable is required");return console.log("Creating Prisma client with DATABASE_URL:",a.substring(0,30)+"..."),new d.PrismaClient({datasources:{db:{url:a}},log:["error","warn"]})})()},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},93590:(a,b,c)=>{"use strict";c.r(b),c.d(b,{patchFetch:()=>o,routeModule:()=>k,serverHooks:()=>n,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>m});var d={};c.r(d),c.d(d,{PATCH:()=>j});var e=c(96559),f=c(48088),g=c(37719),h=c(32190),i=c(13700);async function j(a,{params:b}){try{let{action:c,category:d,notes:e}=await a.json(),f=(await b).id;if("reclassify"===c&&d){let a=await i.z.flaggedItem.update({where:{id:f},data:{category:d.toUpperCase(),aiConfidence:1,status:"CONFIRMED"}});return await i.z.mLFeedback.create({data:{feedbackType:"RECLASSIFY",userAction:"reclassified",correctCategory:d.toUpperCase(),confidence:1,projectId:a.projectId}}),d&&a.impact&&await i.z.timelineEntry.create({data:{title:`Confirmed: ${a.title}`,description:a.description,category:d.toUpperCase(),date:new Date,impact:a.impact,projectId:a.projectId,flaggedItemId:f,verified:!0}}),h.NextResponse.json(a)}if(!c||!({confirm:"CONFIRMED",ignore:"IGNORED",email_sent:"EMAIL_SENT"})[c])return h.NextResponse.json({error:"Invalid action"},{status:400});let g={},j=null;switch(c){case"confirm":g={status:"CONFIRMED",reviewedAt:new Date,userNotes:e||null};let k=await i.z.flaggedItem.findUnique({where:{id:f},include:{project:!0}});k&&(j=await i.z.timelineEntry.create({data:{title:k.title,description:k.description,category:k.category,date:k.emailDate,impact:k.impact,projectId:k.projectId,flaggedItemId:f,verified:!0}}));break;case"ignore":g={status:"IGNORED",reviewedAt:new Date,userNotes:e||null};break;case"email_sent":g={status:"EMAIL_SENT",reviewedAt:new Date,userNotes:e||null};break;default:return h.NextResponse.json({error:"Invalid action"},{status:400})}let l=await i.z.flaggedItem.update({where:{id:f},data:g});return await i.z.mLFeedback.create({data:{feedbackType:"confirm"===c?"POSITIVE":"ignore"===c?"NEGATIVE":"PENDING",userAction:c,flaggedItemId:f,projectId:l.projectId}}),h.NextResponse.json({success:!0,item:l,timelineEntry:j})}catch(a){return console.error("Error updating flagged item:",a),h.NextResponse.json({error:"Failed to update flagged item"},{status:500})}}let k=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/flagged-items/[id]/route",pathname:"/api/flagged-items/[id]",filename:"route",bundlePath:"app/api/flagged-items/[id]/route"},distDir:".next",projectDir:"",resolvedPagePath:"/Users/kennyc/code/personal/nailit/app/api/flagged-items/[id]/route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:l,workUnitAsyncStorage:m,serverHooks:n}=k;function o(){return(0,g.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:m})}},96330:a=>{"use strict";a.exports=require("@prisma/client")},96487:()=>{}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=a=>b(b.s=a),d=b.X(0,[7719,580],()=>c(93590));module.exports=d})();