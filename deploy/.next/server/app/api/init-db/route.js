(()=>{var a={};a.id=9199,a.ids=[9199],a.modules={3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13700:(a,b,c)=>{"use strict";c.d(b,{z:()=>e});var d=c(96330);let e=globalThis.prisma??(()=>{let a="postgresql://neondb_owner:npg_avELx8uqOAc0@ep-still-paper-a5tgtem8-pooler.us-east-2.aws.neon.tech/neondb?sslmode=require".trim();if(!a)throw console.error("DATABASE_URL environment variable is not set"),console.error("Available env vars:",Object.keys(process.env).filter(a=>a.includes("DATABASE")||a.includes("NEON"))),Error("DATABASE_URL environment variable is required");return console.log("Creating Prisma client with DATABASE_URL:",a.substring(0,30)+"..."),new d.PrismaClient({datasources:{db:{url:a}},log:["error","warn"]})})()},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44604:(a,b,c)=>{"use strict";c.r(b),c.d(b,{patchFetch:()=>p,routeModule:()=>l,serverHooks:()=>o,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>n});var d={};c.r(d),c.d(d,{GET:()=>k,POST:()=>j});var e=c(96559),f=c(48088),g=c(37719),h=c(32190),i=c(13700);async function j(){try{console.log("Testing database connection..."),await i.z.$connect(),console.log("Database connection successful"),console.log("Checking if tables exist...");try{let a=await i.z.user.count();return console.log(`Tables exist. Current user count: ${a}`),h.NextResponse.json({status:"Already initialized",userCount:a,message:"Database tables already exist",timestamp:new Date().toISOString()})}catch(a){console.log("Tables do not exist, attempting to create them..."),console.log("Table error:",a instanceof Error?a.message:"Unknown error");try{return console.log("Creating tables using Prisma schema..."),h.NextResponse.json({status:"Tables missing - setup required",error:"Database tables do not exist",message:"Tables need to be created",instructions:["1. Run locally: npx prisma db push --accept-data-loss","2. Or use Neon Console to run SQL schema","3. Or create tables manually"],neonConsole:"Go to Neon Console â†’ SQL Editor and run your schema",tableError:a instanceof Error?a.message:"Unknown error",timestamp:new Date().toISOString()},{status:424})}catch(a){return console.error("Failed to create tables:",a),h.NextResponse.json({status:"Table creation failed",error:a instanceof Error?a.message:"Unknown error",timestamp:new Date().toISOString()},{status:500})}}}catch(a){return console.error("Database connection error:",a),h.NextResponse.json({status:"Connection failed",error:a instanceof Error?a.message:"Unknown error",code:a instanceof Error&&"code"in a?String(a.code):void 0,timestamp:new Date().toISOString()},{status:500})}finally{await i.z.$disconnect()}}async function k(){try{await i.z.$connect();try{let a=await i.z.user.count();return h.NextResponse.json({status:"Connected and initialized",userCount:a,timestamp:new Date().toISOString()})}catch(a){return h.NextResponse.json({status:"Connected but tables missing",error:"Tables do not exist",code:a instanceof Error&&"code"in a?String(a.code):void 0,message:"Use POST /api/init-db to initialize",timestamp:new Date().toISOString()},{status:424})}}catch(a){return h.NextResponse.json({status:"Connection failed",error:a instanceof Error?a.message:"Unknown error",code:a instanceof Error&&"code"in a?String(a.code):void 0,timestamp:new Date().toISOString()},{status:500})}finally{await i.z.$disconnect()}}let l=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/init-db/route",pathname:"/api/init-db",filename:"route",bundlePath:"app/api/init-db/route"},distDir:".next",projectDir:"",resolvedPagePath:"/Users/kennyc/code/personal/nailit/app/api/init-db/route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:m,workUnitAsyncStorage:n,serverHooks:o}=l;function p(){return(0,g.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:n})}},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96330:a=>{"use strict";a.exports=require("@prisma/client")},96487:()=>{}};var b=require("../../../webpack-runtime.js");b.C(a);var c=a=>b(b.s=a),d=b.X(0,[7719,580],()=>c(44604));module.exports=d})();