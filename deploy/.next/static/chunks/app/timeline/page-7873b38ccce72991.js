(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5404],{3160:(e,s,t)=>{Promise.resolve().then(t.bind(t,5162))},5162:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>v});var a=t(5155),l=t(2115),r=t(2885),c=t(4684),i=t(3418),n=t(6124),x=t(2771),m=t(2227),d=t(9089);let o=e=>{let{onExport:s}=e,[t,r]=(0,l.useState)(!1),o=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=e=>{o.current&&!o.current.contains(e.target)&&r(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let h=(e,t)=>{s(e,t),r(!1)};return(0,a.jsxs)("div",{className:"relative",ref:o,children:[(0,a.jsxs)("button",{onClick:()=>r(!t),className:"flex items-center justify-center gap-2 px-3 sm:px-4 py-2 sm:py-2.5 bg-[#34A853] text-white rounded-md hover:bg-[#2D9348] transition-colors font-medium text-sm min-h-[44px] w-full sm:w-auto",children:[(0,a.jsx)(c.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"truncate",children:"Export Timeline"}),(0,a.jsx)(i.A,{className:"w-4 h-4 transition-transform ".concat(t?"rotate-180":"")})]}),t&&(0,a.jsxs)("div",{className:"absolute right-0 sm:right-0 left-0 sm:left-auto mt-1 w-full sm:w-[280px] bg-white rounded-lg shadow-lg py-2 z-50 border border-gray-200",children:[(0,a.jsx)("div",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Export Options"}),(0,a.jsxs)("button",{onClick:()=>h("pdf","current"),className:"w-full flex items-center gap-3 px-4 py-3 sm:py-2.5 hover:bg-gray-50 text-left min-h-[44px] sm:min-h-0",children:[(0,a.jsx)(c.A,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Export as PDF"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Formatted document with timeline"})]}),(0,a.jsx)("span",{className:"hidden sm:block text-xs bg-gray-100 px-2 py-1 rounded text-gray-500 font-mono",children:"⌘P"})]}),(0,a.jsxs)("button",{onClick:()=>h("csv","current"),className:"w-full flex items-center gap-3 px-4 py-3 sm:py-2.5 hover:bg-gray-50 text-left min-h-[44px] sm:min-h-0",children:[(0,a.jsx)(n.A,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Export as CSV"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Spreadsheet format for analysis"})]}),(0,a.jsx)("span",{className:"hidden sm:block text-xs bg-gray-100 px-2 py-1 rounded text-gray-500 font-mono",children:"⌘E"})]}),(0,a.jsx)("div",{className:"h-px bg-gray-200 my-2"}),(0,a.jsx)("div",{className:"px-4 py-2 text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Export Range"}),(0,a.jsxs)("button",{onClick:()=>h("pdf","current"),className:"w-full flex items-center gap-3 px-4 py-3 sm:py-2.5 hover:bg-gray-50 text-left min-h-[44px] sm:min-h-0",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Current View"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Last 30 days of timeline"})]})]}),(0,a.jsxs)("button",{onClick:()=>h("pdf","full"),className:"w-full flex items-center gap-3 px-4 py-3 sm:py-2.5 hover:bg-gray-50 text-left min-h-[44px] sm:min-h-0",children:[(0,a.jsx)(m.A,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Full Timeline"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"All project history"})]})]}),(0,a.jsxs)("button",{onClick:()=>h("pdf","custom"),className:"w-full flex items-center gap-3 px-4 py-3 sm:py-2.5 hover:bg-gray-50 text-left min-h-[44px] sm:min-h-0",children:[(0,a.jsx)(d.A,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:"Custom Range"}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Select specific dates"})]})]})]})]})};var h=t(8960),p=t(2975),u=t(5628),g=t(6865),f=t(6884),j=t(5279),y=t(8593);let N=e=>{let{projectName:s,teamMemberCount:t,lastUpdated:r}=e,[c,i]=(0,l.useState)([]),[n,m]=(0,l.useState)(!0),[d,N]=(0,l.useState)(!1),[w,v]=(0,l.useState)(null),[b,k]=(0,l.useState)("all");(0,l.useEffect)(()=>{A()},[]);let A=async()=>{try{m(!0);let e=await fetch("/api/projects"),s=await e.json();if(0===s.length)return void i([]);let t=s[0].id,a=await fetch("/api/timeline?projectId=".concat(t));if(!a.ok)throw Error("Failed to fetch timeline entries");let l=await a.json();i(l)}catch(e){console.error("Error fetching timeline entries:",e),v("Failed to load timeline")}finally{m(!1)}},C=e=>{switch(e){case"cost":return h.A;case"schedule":return x.A;case"scope":return p.A;case"issue":return u.A;case"update":return g.A;default:return f.A}},E=e=>{switch(e){case"cost":return"bg-red-100 text-red-600 border-red-200";case"schedule":return"bg-blue-100 text-blue-600 border-blue-200";case"scope":return"bg-yellow-100 text-yellow-600 border-yellow-200";case"issue":return"bg-orange-100 text-orange-600 border-orange-200";case"update":return"bg-purple-100 text-purple-600 border-purple-200";default:return"bg-gray-100 text-gray-600 border-gray-200"}},S=e=>{switch(e){case"cost":return"Cost Impact";case"schedule":return"Schedule Update";case"scope":return"Scope Change";case"issue":return"Issue";case"update":return"Update";default:return"Event"}},F="all"===b?c:c.filter(e=>e.category===b),I=[...new Set(c.map(e=>e.category))];return n?(0,a.jsx)("div",{className:"flex flex-col w-full max-w-7xl mx-auto",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"text-gray-500",children:"Loading timeline..."})})})}):w?(0,a.jsx)("div",{className:"flex flex-col w-full max-w-7xl mx-auto",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"text-red-500",children:w})})})}):(0,a.jsxs)("div",{className:"flex flex-col w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-4 sm:space-y-0 sm:flex-row sm:justify-between sm:items-start",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h1",{className:"text-xl sm:text-2xl font-semibold text-gray-900 mb-2",children:s}),(0,a.jsxs)("div",{className:"flex flex-col space-y-2 sm:space-y-0 sm:flex-row sm:gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsxs)("svg",{className:"w-4 h-4 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,a.jsx)("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),(0,a.jsx)("circle",{cx:"9",cy:"7",r:"4"}),(0,a.jsx)("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),(0,a.jsx)("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),(0,a.jsxs)("span",{className:"truncate",children:[t," team member",1!==t?"s":""]})]}),(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsxs)("svg",{className:"w-4 h-4 flex-shrink-0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("polyline",{points:"12 6 12 12 16 14"})]}),(0,a.jsxs)("span",{className:"truncate",children:["Last updated ",r]})]}),(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.A,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsxs)("span",{className:"truncate",children:[c.length," event",1!==c.length?"s":""]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-2 w-full sm:w-auto",children:[(0,a.jsxs)("button",{onClick:()=>{N(!0),setTimeout(()=>{A(),N(!1)},1e3)},disabled:d,className:"flex items-center justify-center gap-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-800 disabled:opacity-50 border border-gray-200 rounded-md hover:bg-gray-50 min-h-[44px] w-full sm:w-auto",children:[(0,a.jsx)(j.A,{className:"w-4 h-4 ".concat(d?"animate-spin":"")}),(0,a.jsx)("span",{children:d?"Refreshing...":"Refresh"})]}),(0,a.jsx)("div",{className:"w-full sm:w-auto",children:(0,a.jsx)(o,{onExport:(e,s)=>{console.log("Exporting ".concat(e," for range: ").concat(s))}})})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)("button",{onClick:()=>k("all"),className:"px-3 py-2 rounded-full text-sm font-medium transition-colors min-h-[44px] ".concat("all"===b?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:["All (",c.length,")"]}),I.map(e=>(0,a.jsxs)("button",{onClick:()=>k(e),className:"px-3 py-2 rounded-full text-sm font-medium transition-colors min-h-[44px] ".concat(b===e?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[S(e)," (",c.filter(s=>s.category===e).length,")"]},e))]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 sm:p-6",children:0===F.length?(0,a.jsxs)("div",{className:"text-center text-gray-500 py-8 sm:py-12",children:[(0,a.jsx)(f.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"No timeline entries"}),(0,a.jsx)("p",{className:"text-sm sm:text-base text-gray-500",children:"all"===b?"Project timeline will appear here as events are confirmed.":"No ".concat(S(b.toLowerCase())," events found.")})]}):(0,a.jsx)("div",{className:"space-y-4 sm:space-y-6",children:F.map((e,s)=>{let t=C(e.category),l=s===F.length-1;return(0,a.jsxs)("div",{className:"relative",children:[!l&&(0,a.jsx)("div",{className:"absolute left-4 sm:left-6 top-10 sm:top-12 w-0.5 h-full bg-gray-200"}),(0,a.jsxs)("div",{className:"flex gap-3 sm:gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-8 h-8 sm:w-12 sm:h-12 rounded-full border-2 flex items-center justify-center ".concat(E(e.category)),children:(0,a.jsx)(t,{className:"w-4 h-4 sm:w-6 sm:h-6"})}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-2 sm:gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-1",children:[(0,a.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 break-words",children:e.title}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(0,a.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium ".concat(E(e.category)),children:S(e.category)}),e.fromFlaggedItem&&(0,a.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:"From Email"}),e.verified&&(0,a.jsx)(g.A,{className:"w-4 h-4 text-green-500"})]})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-2 text-sm sm:text-base break-words",children:e.description}),e.impact&&(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-800 mb-2 break-words",children:["Impact: ",e.impact]}),(0,a.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[e.cost&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsxs)("span",{className:"break-words",children:["Cost Impact: $",e.cost.toLocaleString()]})]}),e.scheduleImpact&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsxs)("span",{className:"break-words",children:["Schedule: ",e.scheduleImpact]})]}),e.scopeDetails&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsxs)("span",{className:"break-words",children:["Scope: ",e.scopeDetails]})]}),e.emailFrom&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsxs)("span",{className:"break-words",children:["From: ",e.emailFrom]})]})]})]}),(0,a.jsxs)("div",{className:"text-right sm:text-right text-left text-sm text-gray-500 flex-shrink-0",children:[(0,a.jsx)("div",{children:e.time}),(0,a.jsx)("div",{children:e.date})]})]})})]})]},e.id)})})})]})};var w=t(4768);function v(){let[e,s]=(0,l.useState)(null),[t,c]=(0,l.useState)(!0),[i,n]=(0,l.useState)(null);(0,l.useEffect)(()=>{x()},[]);let x=async()=>{try{let e=await fetch("/api/projects"),t=await e.json();t.length>0&&s(t[0])}catch(e){console.error("Error fetching project:",e),n("Error fetching project. Please try again later.")}finally{c(!1)}};return t?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(r.V,{}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#34A853]"}),(0,a.jsx)("div",{className:"text-gray-600 font-medium",children:"Loading timeline..."})]})})})]}):i?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(r.V,{}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)("div",{className:"text-red-500 text-6xl",children:"⚠️"}),(0,a.jsx)("div",{className:"text-red-600 font-medium",children:i}),(0,a.jsx)(w.$,{onClick:()=>{n(null),x()},className:"bg-[#34A853] hover:bg-[#2d8f47]",children:"Try Again"})]})})})]}):e?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(r.V,{}),(0,a.jsx)("main",{className:"py-8",children:(0,a.jsx)(N,{projectName:e.name,teamMemberCount:(null==e?void 0:e.contractor)?2:1,lastUpdated:(e=>{let s=new Date(e.createdAt),t=Math.floor((new Date().getTime()-s.getTime())/36e5);if(t<1)return"Just now";{if(t<24)return"".concat(t," hour").concat(1===t?"":"s"," ago");let e=Math.floor(t/24);return"".concat(e," day").concat(1===e?"":"s"," ago")}})(e)})})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(r.V,{}),(0,a.jsx)("main",{className:"py-8",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,a.jsxs)("div",{className:"text-center text-gray-500 py-12",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No project found"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Create a project to view its timeline."})]})})})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[4277,2108,6874,2628,4284,8441,1684,7358],()=>s(3160)),_N_E=e.O()}]);